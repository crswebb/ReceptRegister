From 221dd087743a5cddbfa70c3d1a7b098f4fc0f102 Mon Sep 17 00:00:00 2001
From: stefa <stefa@DESKTOP-JFUT92A>
Date: Sat, 23 Aug 2025 20:58:00 +0200
Subject: [PATCH 2/4] feat(frontend-5 #34 #41): recipe list/search page
 (postback) + forms.css & table.css

---
 .../Pages/Recipes/Index.cshtml                | 47 ++++++++++++++++++-
 .../Pages/Recipes/Index.cshtml.cs             | 15 +++++-
 .../Pages/Shared/_Layout.cshtml               |  2 +
 ReceptRegister.Frontend/wwwroot/css/forms.css | 21 +++++++++
 ReceptRegister.Frontend/wwwroot/css/table.css | 12 +++++
 5 files changed, 93 insertions(+), 4 deletions(-)
 create mode 100644 ReceptRegister.Frontend/wwwroot/css/forms.css
 create mode 100644 ReceptRegister.Frontend/wwwroot/css/table.css

diff --git a/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml b/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml
index 17bfeeb..6e5e256 100644
--- a/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml
+++ b/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml
@@ -4,5 +4,48 @@
     ViewData["Title"] = "Recipes";
 }
 <h1>Recipes</h1>
-<p>This is the starting point for recipe search and list (Milestone 5).</p>
-<p>Progressive enhancement will add live search; for now this will remain a simple postback form.</p>
+<form method="get" class="form-inline" role="search" aria-label="Recipe search">
+    <label for="search" class="visually-hidden">Search</label>
+    <input id="search" name="Search" value="@Model.Search" placeholder="Search name, book, category, keyword" />
+    <button type="submit">Search</button>
+    @if (!string.IsNullOrWhiteSpace(Model.Search)) {
+        <a href="/Recipes/Index" class="reset-link">Clear</a>
+    }
+</form>
+<p class="result-count">@Model.Results.Count recipe@(Model.Results.Count == 1 ? "" : "s") found.</p>
+<table class="recipes-table">
+    <thead>
+    <tr>
+        <th scope="col">Name</th>
+        <th scope="col">Book</th>
+        <th scope="col">Page</th>
+        <th scope="col">Categories</th>
+        <th scope="col">Keywords</th>
+        <th scope="col">Tried</th>
+    </tr>
+    </thead>
+    <tbody>
+    @foreach (var r in Model.Results) {
+        <tr>
+            <td><a href="/Recipes/Detail/@r.Id">@r.Name</a></td>
+            <td>@r.Book</td>
+            <td>@r.Page</td>
+            <td>
+                @if (r.Categories.Count == 0) { <span class="muted">—</span>; } else {
+                    <ul class="inline-list">@foreach (var c in r.Categories) { <li>@c.Name</li> }</ul>
+                }
+            </td>
+            <td>
+                @if (r.Keywords.Count == 0) { <span class="muted">—</span>; } else {
+                    <ul class="inline-list">@foreach (var k in r.Keywords) { <li>@k.Name</li> }</ul>
+                }
+            </td>
+            <td>@(r.Tried ? "✔" : "")</td>
+        </tr>
+    }
+    </tbody>
+</table>
+@if (Model.Results.Count == 0)
+{
+    <p class="empty">No recipes yet. <a href="/Recipes/Create">Add one</a>.</p>
+}
diff --git a/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml.cs b/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml.cs
index 2d4fd83..21f9c6c 100644
--- a/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml.cs
+++ b/ReceptRegister.Frontend/Pages/Recipes/Index.cshtml.cs
@@ -1,11 +1,22 @@
+using Microsoft.AspNetCore.Mvc;
 using Microsoft.AspNetCore.Mvc.RazorPages;
+using ReceptRegister.Api.Data;
+using ReceptRegister.Api.Domain;
 
 namespace ReceptRegister.Frontend.Pages.Recipes;
 
 public class IndexModel : PageModel
 {
-    public void OnGet()
+    private readonly IRecipesRepository _repo;
+    public IndexModel(IRecipesRepository repo) => _repo = repo;
+
+    [BindProperty(SupportsGet = true)]
+    public string? Search { get; set; }
+
+    public IReadOnlyList<Recipe> Results { get; private set; } = Array.Empty<Recipe>();
+
+    public async Task OnGetAsync(CancellationToken ct)
     {
-        // Placeholder for initial list retrieval (Milestone 5)
+        Results = await _repo.SearchAsync(Search, ct);
     }
 }
diff --git a/ReceptRegister.Frontend/Pages/Shared/_Layout.cshtml b/ReceptRegister.Frontend/Pages/Shared/_Layout.cshtml
index 1e7b395..84bc1ad 100644
--- a/ReceptRegister.Frontend/Pages/Shared/_Layout.cshtml
+++ b/ReceptRegister.Frontend/Pages/Shared/_Layout.cshtml
@@ -5,6 +5,8 @@
     <meta name="viewport" content="width=device-width, initial-scale=1" />
     <title>@(ViewData["Title"] is null ? "ReceptRegister" : ViewData["Title"] + " · ReceptRegister")</title>
     <link rel="stylesheet" href="/css/base.css" asp-append-version="true" />
+    <link rel="stylesheet" href="/css/forms.css" asp-append-version="true" />
+    <link rel="stylesheet" href="/css/table.css" asp-append-version="true" />
     <link rel="stylesheet" href="/css/site.css" asp-append-version="true" />
     <style>
         /* Lightweight structural layout (Milestone 5 foundation) */
diff --git a/ReceptRegister.Frontend/wwwroot/css/forms.css b/ReceptRegister.Frontend/wwwroot/css/forms.css
new file mode 100644
index 0000000..86cc713
--- /dev/null
+++ b/ReceptRegister.Frontend/wwwroot/css/forms.css
@@ -0,0 +1,21 @@
+/* forms.css - milestone 5 (#41) foundational form styles */
+:root {
+    --focus-ring: 2px solid #1d74d8;
+}
+form { margin-block: 1rem 1.5rem; }
+input[type=text], input[type=search], input[type=number], input[type=password], textarea {
+    font: inherit;
+    padding: .4rem .55rem;
+    border: 1px solid #888;
+    border-radius: 4px;
+    min-width: 14rem;
+}
+input:focus, textarea:focus { outline: var(--focus-ring); outline-offset: 1px; }
+button { font: inherit; padding: .45rem .9rem; border: 1px solid #1d74d8; background:#1d74d8; color:#fff; border-radius:4px; cursor:pointer; }
+button:focus { outline: var(--focus-ring); outline-offset: 2px; }
+button:hover { background:#155aab; border-color:#155aab; }
+.reset-link { margin-left:.5rem; font-size:.85rem; }
+.form-inline { display:flex; flex-wrap:wrap; gap:.5rem; align-items:center; }
+.visually-hidden { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }
+.muted { color:#666; }
+.result-count { font-size:.85rem; margin-top:-.25rem; }
diff --git a/ReceptRegister.Frontend/wwwroot/css/table.css b/ReceptRegister.Frontend/wwwroot/css/table.css
new file mode 100644
index 0000000..ea4686f
--- /dev/null
+++ b/ReceptRegister.Frontend/wwwroot/css/table.css
@@ -0,0 +1,12 @@
+/* table.css - milestone 5 (#41) table/list presentation */
+table { border-collapse:collapse; width:100%; font-size:.95rem; }
+th, td { text-align:left; padding:.4rem .5rem; vertical-align:top; }
+thead th { background:#f2f2f2; font-weight:600; border-bottom:2px solid #ccc; }
+tbody tr:nth-child(even) { background:#fafafa; }
+tbody tr:hover { background:#eef6ff; }
+td a { text-decoration:none; }
+td a:focus, td a:hover { text-decoration:underline; }
+.recipes-table { margin-top:.75rem; }
+ul.inline-list { list-style:none; margin:0; padding:0; display:flex; flex-wrap:wrap; gap:.3rem; }
+ul.inline-list li { background:#e1e7ef; padding:.15rem .45rem; border-radius:999px; font-size:.7rem; text-transform:uppercase; letter-spacing:.5px; }
+.empty { font-style:italic; color:#555; }
\ No newline at end of file
-- 
2.39.2.windows.1

